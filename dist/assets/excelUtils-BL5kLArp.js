import{u as e,w as t,r}from"./utils-B_sx4vTC.js";const a=(r,a,o="Sheet1")=>{try{const n=e.book_new(),s=e.json_to_sheet(r),u=[];return r.length>0&&(Object.keys(r[0]).forEach((e,t)=>{const a=Math.max(e.length,...r.map(t=>String(t[e]||"").length));u.push({wch:Math.min(a+2,30)})}),s["!cols"]=u),e.book_append_sheet(n,s,o),t(n,`${a}.xlsx`),!0}catch(n){return!1}},o=t=>new Promise((a,o)=>{const n=new FileReader;n.onload=t=>{try{const o=new Uint8Array(t.target.result),n=r(o,{type:"array"}),s=n.SheetNames[0],u=n.Sheets[s],c=e.sheet_to_json(u);a(c)}catch(n){o(n)}},n.onerror=e=>{o(e)},n.readAsArrayBuffer(t)}),n=e=>{const t=[],r=["项目名称","项目编码","所属区域","项目类别","建设单位","项目主管部门"];return e.forEach((e,a)=>{r.forEach(r=>{e[r]||t.push(`第${a+1}行缺少必填字段: ${r}`)}),e["项目状态"]&&!["在建","续建","完工","暂停"].includes(e["项目状态"])&&t.push(`第${a+1}行项目状态值无效: ${e["项目状态"]}`)}),t},s=e=>{const t=[],r=["项目名称","项目编码","资金批复金额","资金具体来源","资金性质"],a=["地方-一般债券","地方-专项债券","中央-中央综合财力","地方-土地出让金","地方-一般公共预算","中央-中央预算内投资","中央-中央补助","省级-省级补助","省级-省级专项","中央-中央专项","中央-国债","中央-超长期国债","中央-抗疫特别国债"],o=["地方","中央","省级"];return e.forEach((e,n)=>{r.forEach(r=>{e[r]||t.push(`第${n+1}行缺少必填字段: ${r}`)}),e["资金具体来源"]&&!a.includes(e["资金具体来源"])&&t.push(`第${n+1}行资金具体来源值无效: ${e["资金具体来源"]}`),e["资金性质"]&&!o.includes(e["资金性质"])&&t.push(`第${n+1}行资金性质值无效: ${e["资金性质"]}`),e["资金批复金额"]&&isNaN(Number(e["资金批复金额"]))&&t.push(`第${n+1}行资金批复金额格式错误: ${e["资金批复金额"]}`)}),t},u=e=>e.map((e,t)=>({key:`import_${t}`,projectName:e["项目名称"]||"",projectCode:e["项目编码"]||"",area:e["所属区域"]||"",category:e["项目类别"]||"",constructionUnit:e["建设单位"]||"",department:e["项目主管部门"]||"",approvalTime:e["立项时间"]||"",budgetAmount:e["概算批复金额"]||"",startTime:e["（预计）开工时间"]||"",endTime:e["（预计）完工时间"]||"",status:e["项目状态"]||""})),c=e=>e.map((e,t)=>({key:`import_${t}`,projectName:e["项目名称"]||"",projectCode:e["项目编码"]||"",area:e["所属区域"]||"",category:e["项目类别"]||"",constructionUnit:e["建设单位"]||"",department:e["项目主管部门"]||"",budgetAmount:e["概算批复金额"]||"",fundingAmount:e["资金批复金额"]||"",approvalDate:e["批复日期"]||"",fundingSource:e["资金具体来源"]||"",fundingNature:e["资金性质"]||"",documentNumber:e["财预文号"]||"",operator:e["经办人"]||"",operatorDepartment:e["经办处室"]||"",status:e["项目状态"]||"",remark:e["备注"]||""})),p=e=>e.map(e=>({"项目名称":e.projectName,"项目编码":e.projectCode,"所属区域":e.area,"项目类别":e.category,"建设单位":e.constructionUnit,"项目主管部门":e.department,"立项时间":e.approvalTime,"概算批复金额":e.budgetAmount,"（预计）开工时间":e.startTime,"（预计）完工时间":e.endTime,"项目状态":e.status})),m=e=>e.map(e=>({"项目名称":e.projectName,"项目编码":e.projectCode,"所属区域":e.area,"项目类别":e.category,"建设单位":e.constructionUnit,"项目主管部门":e.department,"概算批复金额":e.budgetAmount,"资金批复金额":e.fundingAmount,"批复日期":e.approvalDate,"资金具体来源":e.fundingSource,"资金性质":e.fundingNature,"财预文号":e.documentNumber,"经办人":e.operator,"经办处室":e.operatorDepartment,"项目状态":e.status,"备注":e.remark}));export{u as a,m as b,s as c,c as d,a as e,o as i,p as t,n as v};
